<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />


    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@100&family=Ubuntu&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Bagel+Fat+One&family=Belanosima:wght@400;600;700&family=Cherry+Bomb+One&family=Gasoek+One&family=Moirai+One&display=swap"
    rel="stylesheet">
    <style>
        * {
            margin: 0;
            /* font-family: 'Bagel Fat One', cursive; */
            /* font-family: 'Raleway', sans-serif; */
            font-family: 'Ubuntu', sans-serif;
        }


        #left {
            position: fixed;
            height: 99vh;
            width: 350px;
            /* border: 2px solid red; */
            color: white;
            background-image: url("http://localhost:5050/images/cropedmonth.jpg");
        }

        #left>div>button {
            display: block;
            width: 250px;
            padding: 10px;
            margin: 5px;
            background-color: rgba(181, 168, 168, 0.161);
            backdrop-filter: blur(5px);
            font-size: 20px;
            /* font-weight: bolder; */
            color: white;
            cursor: pointer;
            /* border-radius: 1.5rem; */
            /* border: none; */
            border: 4px solid black;
        }

        #left>div>h3 {
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 20px;
            font-weight: bolder;
        }

        #left>div {
            margin-left: 50px;
            margin-top: 20px;
        }

        #right {

            overflow: auto;
            /* border: 2px solid red; */
            width: 76%;
            height: 99vh;
            margin-left: 354px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: auto;
            gap: 20px;
            background-color: rgba(248, 248, 248, 0.907);
        }

        #right>div {
            cursor: pointer;
            /* border: 2px solid green; */
            /* padding: 10px; */
            background-color: white;
            box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;
        }

        #right>div>img {
            width: 350px;
            /* height: 50px; */
        }

        .prod {
            font-size: 20px;
            font-weight: bolder;
            margin-left: 20px;
        }

        .rating {
            /* text-align: right; */
            margin-left: 280px;
            font-size: larger;
            margin-bottom: 20px;
            /* border: 2px solid red; */
            display: inline-block;
        }

        .price {
            display: inline-block;
            /* border: 1px solid green; */
            margin-left: 20px;
            font-size: 20px;
            margin-top: 5px;
        }

        #star {
            color: green;
            font-size: 20px;
            /* display: inline-block;
    margin-bottom: 30px;
    border: 2px solid red; */
            /* margin-bottom: 10px; */
        }









        /* first nav css */

        #firstnav {
            font-family: 'Belanosima', sans-serif;
            height: 60px;
            color: white;
            display: flex;
            /* border: 2px solid red; */
            justify-content: space-between;
            background: linear-gradient(to right, #434343, #8f8d8d, #302f2f, #000000);
        }

        #firstnav>div {
            font-family: 'Belanosima', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            /* border: 2px solid yellow; */
            justify-content: space-around;

        }

        #firstnav1 {
            font-family: 'Belanosima', sans-serif;
            width: 500px;
            font-size: 20px;
            /* margin-left: -80px; */
        }

        #firstnav1>div {
            font-family: 'Belanosima', sans-serif;
            cursor: pointer;
        }

        #firstnav2 {
            font-family: 'Belanosima', sans-serif;
            font-size: 40px;
            font-weight: bolder;
            margin-left: -450px;
            cursor: pointer;

        }

        /* #userHoverOption{
    display: none;
    /* margin-left: -100px; */
        /* }
#userHover{
    margin-left: -200px;
}
#userHover:hover #userHoverOption{
display: block;
} */


        /* user hover */
        #userHover {
            /* border: 2px solid red; */
            position: relative;
            width: 30px;
            text-align: center;
            margin-left: -150px;
            cursor: pointer;
        }

        #userHover:hover #userHoverOption {
            display: block;
            /* opacity: 1; */
        }

        #userHoverOption {
            box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;
            transition: 3s;
            position: absolute;
            right: 2px;
            width: 200px;
            display: none;
            color: black;
            background-color: rgba(255, 255, 255, 0.216);
            backdrop-filter: blur(10px);
            z-index: 10000;

        }

        #userHoverOption div {
            display: block;
            border: 1px solid rgb(47, 41, 41);
            padding: 10px;
            margin: 5px;
            text-decoration: none;
            font-size: 20px;
            cursor: pointer;
        }

        #userHoverOption div:hover {
            background-color: rgba(179, 160, 160, 0.173);
            backdrop-filter: blur(7px);
            /* color: white; */
        }

























    </style>
</head>

<body>



<!-- first navbar -->
<div id="firstnav">
    <div id="firstnav1">

        <div onclick='window.location.href="http://localhost:5050/public/shop.html"'>shop</div>
        <div onclick='window.location.href="http://localhost:5050/public/about.html"'>About us</div>
        <div onclick='window.location.href="http://localhost:5050/public/blog.html"'>Blog</div>
        <div>Contact</div>
    </div>
    <div onclick='window.location.href="http://localhost:5050/public/index.html"' id="firstnav2">
        CHAMPION
    </div>
    <div id="firstnav3">
        <div id="userHover">
            <i style="font-size: 20px;" class="fa-regular fa-user"></i>
            <div id="userHoverOption">
                <div id="customerSignup"
                    onclick="window.location.href='http://localhost:5050/public/customerSign.html'">Customer Signup
                </div>
                <div id="customerLogin"
                    onclick="window.location.href='http://localhost:5050/public/customerLogin.html'">Customer Login
                </div>
                <div id="adminLogin" onclick="window.location.href='http://localhost:5050/public/adminLogin.html'">
                    Admin Login</div>
            </div>
        </div>
    </div>
</div>
























    <div id="main">
        <div id="left">
            <div id="inLeft">
                <h3>Price</h3>
                <button id="price1">Low to High</button>
                <button id="price2">High to Low</button>
                <h3>Rating</h3>
                <button id="rate1">Low to High</button>
                <button id="rate2">High to Low</button>
                <h3>Sort</h3>
                <button id="sort1">Alphabetically, A-Z </button>
                <button id="sort2">Alphabetically, Z-A</button>
            </div>
        </div>
        <div id="right">

        </div>
    </div>
</body>

</html>

<script>
   
   

    let ur = new URLSearchParams(window.location.search)
    let id = ur.get('id')
    let gt= async()=>{
    let mainUrl=`http://localhost:5050/product/category/${id}`
    let ans= await fetch(mainUrl,{
        method:'GET',
        headers:{
            'Content-type':'Application/json'
        }
    })
    let res= await ans.json()
    console.log(res);
    document.querySelector("#right").innerHTML=''
    res.forEach(el => {
      
        document.querySelector("#right").innerHTML+=`
        <div id="${el.id}" >
            <img src="${el.image}" alt="">
            <p class="prod">${el.name}</p>
            <p class="price">${el.price}$</p>
            <p class="rating">${el.rating}<i class="fa-solid fa-star"  id="star" ></i></p>   
        </div>
        ` 
    });

    document.querySelectorAll("#right>div").forEach(el => {
        el.addEventListener("click",productPage)
    });
   
}

gt()











// ------------------------------TRACKER SYSTEM-------------------------------------

let events = [];
let visitorId;
let eventy = []

window.addEventListener("load", async () => {
    try {
        let ans = await fetch("http://localhost:5050/current", {
            method: 'GET',
            headers: {
                'content-type': 'application/json'
            }
        });
        let res = await ans.text();
        visitorId = res;
    } catch (error) {
        console.log(error);
    }
    console.log("window loaded of champion")
    eventy.push({
        eventType: 'load',
        url: window.location.href,
        time: new Date().getTime(),
        visitorId: visitorId
    });
    console.log(eventy)
});

document.addEventListener('click', async function (e) {
    eventy.push({
        eventType: 'click',
        x: e.pageX,
        y: e.pageY,
        time: new Date().getTime(),
        visitorId: visitorId
    });
    events = eventy
    eventy = []
    storePost(events)
});

async function storePost(events) {
    let eventUrl = "http://localhost:5050/event"
    await fetch(eventUrl, {
        method: 'POST',
        headers: {
            'Content-type': 'Application/json'
        },
        body: JSON.stringify(events)
    })
    events = []
}

document.addEventListener('mousemove', async function (e) {

    eventy.push({
        eventType: 'mousemove',
        x: e.pageX,
        y: e.pageY,
        time: new Date().getTime(),
        visitorId: visitorId
    });

    console.log("first event", eventy)
    if (eventy.length > 1000) {
        events = eventy;
        eventy = [];
        storePost(events)
    }
    console.log("last events", eventy)
});

window.addEventListener('scroll', (event) => {
    eventy.push({
        eventType: 'scroll',
        scrollPosition: window.scrollY,
        time: new Date().getTime(),
        visitorId: visitorId
    })
    // console.log(events)
})

window.addEventListener('beforeunload', async (event) => {
    events = eventy;
    eventy = [];
    storePost(events)
})










// category products price asc order
document.querySelector("#price1").addEventListener("click",async()=>{

    eventy.push({
        eventType: 'price1', 
        time: new Date().getTime(),
        visitorId: visitorId
    })



    let url=`http://localhost:5050/product/category/${id}/price/asc`
    let ans= await fetch(url,{
        method:'GET',
        headers:{
            'Content-type':'Application/json'
        }
    })
    let res= await ans.json()
    console.log(res);
    document.querySelector("#right").innerHTML=''
    res.forEach(el => {
      
        document.querySelector("#right").innerHTML+=`
        <div id="${el.id}" >
            <img src="${el.image}" alt="">
            <p class="prod">${el.name}</p>
            <p class="price">${el.price}$</p>
            <p class="rating">${el.rating}<i class="fa-solid fa-star" id="star"></i> </p>   
        </div>
        ` 
    });
   
    document.querySelectorAll("#right>div").forEach(el => {
        el.addEventListener("click",productPage)
    });

})

// category products price DESC order
document.querySelector("#price2").addEventListener("click",async ()=>{
    eventy.push({
        eventType: 'price2', 
        time: new Date().getTime(),
        visitorId: visitorId
    })

    let url=`http://localhost:5050/product/category/${id}/price/desc`
    let ans= await fetch(url,{
        method:'GET',
        headers:{
            'Content-type':'Application/json'
        }
    })
    let res= await ans.json()
    console.log(res);
    document.querySelector("#right").innerHTML=''
    res.forEach(el => {
      
        document.querySelector("#right").innerHTML+=`
        <div id="${el.id}" >
            <img src="${el.image}" alt="">
            <p class="prod">${el.name}</p>
            <p class="price">${el.price}$</p>
            <p class="rating">${el.rating}<i class="fa-solid fa-star" id="star"></i> </p>   
        </div>
        ` 
    });
    document.querySelectorAll("#right>div").forEach(el => {
        el.addEventListener("click",productPage)
    });

})







// category products rating asc order
document.querySelector("#rate1").addEventListener("click",async ()=>{

    eventy.push({
        eventType: 'rate1', 
        time: new Date().getTime(),
        visitorId: visitorId
    })

    let url=`http://localhost:5050/product/category/${id}/rate/asc`
    let ans= await fetch(url,{
        method:'GET',
        headers:{
            'Content-type':'Application/json'
        }
    })
    let res= await ans.json()
    console.log(res);
    document.querySelector("#right").innerHTML=''
    res.forEach(el => {
      
        document.querySelector("#right").innerHTML+=`
        <div id="${el.id}" >
            <img src="${el.image}" alt="">
            <p class="prod">${el.name}</p>
            <p class="price">${el.price}$</p>
            <p class="rating">${el.rating}<i class="fa-solid fa-star" id="star"></i> </p>   
        </div>
        ` 
    });
    document.querySelectorAll("#right>div").forEach(el => {
        el.addEventListener("click",productPage)
    });

})



// category products rating DESC order
document.querySelector("#rate2").addEventListener("click",async ()=>{

    eventy.push({
        eventType: 'rate2', 
        time: new Date().getTime(),
        visitorId: visitorId
    })



    let url=`http://localhost:5050/product/category/${id}/rate/desc`
    let ans= await fetch(url,{
        method:'GET',
        headers:{
            'Content-type':'Application/json'
        }
    })
    let res= await ans.json()
    console.log(res);
    document.querySelector("#right").innerHTML=''
    res.forEach(el => {
        document.querySelector("#right").innerHTML+=`
        <div id="${el.id}" >
            <img src="${el.image}" alt="">
            <p class="prod">${el.name}</p>
            <p class="price">${el.price}$</p>
            <p class="rating">${el.rating}<i class="fa-solid fa-star" id="star"></i> </p>   
        </div>
        ` 
    });
   
    document.querySelectorAll("#right>div").forEach(el => {
        el.addEventListener("click",productPage)
    });
})

// category products product name AtoZ order
document.querySelector("#sort1").addEventListener("click",async ()=>{

    eventy.push({
        eventType: 'sort1', 
        time: new Date().getTime(),
        visitorId: visitorId
    })

    let url=`http://localhost:5050/product/category/${id}/sort/asc`
    let ans= await fetch(url,{
        method:'GET',
        headers:{
            'Content-type':'Application/json'
        }
    })
    let res= await ans.json()
    console.log(res);
    document.querySelector("#right").innerHTML=''
    res.forEach(el => {
      
        document.querySelector("#right").innerHTML+=`
        <div id="${el.id}" >
            <img src="${el.image}" alt="">
            <p class="prod">${el.name}</p>
            <p class="price">${el.price}$</p>
            <p class="rating">${el.rating}<i class="fa-solid fa-star" id="star"></i></p>   
        </div>
        ` 
    });
    document.querySelectorAll("#right>div").forEach(el => {
        el.addEventListener("click",productPage)
    });

})



// category products product name DESC order
document.querySelector("#sort2").addEventListener("click",async ()=>{

    eventy.push({
        eventType: 'sort2', 
        time: new Date().getTime(),
        visitorId: visitorId
    })

    let url=`http://localhost:5050/product/category/${id}/sort/desc`
    let ans= await fetch(url,{
        method:'GET',
        headers:{
            'Content-type':'Application/json'
        }
    })
    let res= await ans.json()
    console.log(res);
    document.querySelector("#right").innerHTML=''
    res.forEach(el => {
      
        document.querySelector("#right").innerHTML+=`
        <div id="${el.id}" >
            <img src="${el.image}" alt="">
            <p class="prod">${el.name}</p>
            <p class="price">${el.price}$</p>
            <p class="rating">${el.rating}<i class="fa-solid fa-star" id="star"></i></p>   
        </div>
        ` 
    });
   
    document.querySelectorAll("#right>div").forEach(el => {
        el.addEventListener("click",productPage)
    });

})










 



async function productPage(){
    let ans= this.id
    window.location.href=`http://localhost:5050/public/product.html?id=${ans}`
    //  =`http://localhost:5050/product/${ans}`
}



































 



</script>